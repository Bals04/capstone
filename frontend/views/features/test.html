<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chuchu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-sm">
        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Result filter feature</h2>
        <div class="relative">
            <input type="text" id="autocomplete-input" placeholder="Type something..."
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
            <div id="autocomplete-suggestions"
                class="absolute w-full bg-white border border-red-300 rounded-lg mt-1 shadow-lg z-10"></div>
        </div>
    </div>

    <script>

        const input = document.getElementById('autocomplete-input');
        const suggestionsContainer = document.getElementById('autocomplete-suggestions');

        input.addEventListener('input', async function () {
            const query = this.value.toLowerCase();
            suggestionsContainer.innerHTML = '';

            try {
                const response = await axios.get('http://localhost:3000/searchFilter', {
                    params: {
                        userInput: query
                    }
                });
                const data = response.data;
                data[0].forEach(suggestion => {
                    // Create the container for each suggestion
                    const suggestionElement = document.createElement('div');
                    suggestionElement.classList.add('px-4', 'py-2', 'cursor-pointer', 'hover:bg-red-100', 'autocomplete-suggestion', 'flex', 'items-center', 'gap-2');

                    // Create the image element
                    const imgElement = document.createElement('img');
                    imgElement.src = suggestion.img; // Replace with the actual property name for the image URL
                    imgElement.alt = suggestion.gym_name; // Provide an alt text for accessibility
                    imgElement.classList.add('w-16', 'h-16', 'object-cover', 'rounded-md'); // Adjust size and styling as needed

                    // Create the text element
                    const textElement = document.createElement('div');
                    textElement.textContent = suggestion.gym_name;
                    textElement.classList.add('ml-2', 'text-gray-800'); // Adjust text styling as needed

                    // Append image and text to the suggestion container
                    suggestionElement.appendChild(imgElement);
                    suggestionElement.appendChild(textElement);

                    // Add click event listener
                    suggestionElement.addEventListener('click', function () {
                        input.value = suggestion.gym_name; // Set input value to the gym name
                        console.log(`Gym ID: ${suggestion.gym_id}`)
                        console.log(`Gym name: ${suggestion.gym_name}`)
                        suggestionsContainer.innerHTML = ''; // Clear suggestions
                    });

                    // Append the suggestion element to the suggestions container
                    suggestionsContainer.appendChild(suggestionElement);
                });
            } catch (error) {
                console.error('Error filtering the input:', error);
            }
            // if (query.length > 0) {
            //     const filteredSuggestions = suggestions.filter(item => item.startsWith(query));
            //     filteredSuggestions.forEach(suggestion => {
            //         const suggestionElement = document.createElement('div');
            //         suggestionElement.classList.add('px-4', 'py-2', 'cursor-pointer', 'hover:bg-gray-100', 'autocomplete-suggestion');
            //         suggestionElement.textContent = suggestion;
            //         suggestionElement.addEventListener('click', function() {
            //             input.value = suggestion;
            //             suggestionsContainer.innerHTML = '';
            //         });
            //         suggestionsContainer.appendChild(suggestionElement);
            //     });
            // }
        });

        // Close the suggestions list when clicking outside
        document.addEventListener('click', function (event) {
            if (event.target !== input) {
                suggestionsContainer.innerHTML = '';
            }
        });
    </script>

</body>

</html>