<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin | Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="../../dist/tailwind.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"></script>
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
    <script src="/frontend/scripts/auth.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Aldrich&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap');

        .page_title {
            border-bottom: 2px solid;
            border-image: linear-gradient(to right, #EC7E4A 50%, transparent 50%) 1;
        }

        .sidebar,
        .sidebar-links {
            overflow-x: hidden;
        }

        .sidebar:hover .Menu {
            opacity: 1;
        }

        .sidebar:hover .menu-separator {
            transition-delay: 0s;
            transform: scaleX(0);
        }

        #view_pending th {
            padding-top: 12px;
            padding-bottom: 12px;
            background-color: #EC7E4A;
            color: white;
        }

        #view_pending tr:nth-child(even) {
            background-color: #5F6163;
        }

        #view_pending td,
        #view_pending th {
            border: 1px solid #ddd;
            padding: 8px;
        }

        .calendar {
            padding: 20px;
        }

        .calendar .days {
            margin-bottom: 15px;
        }

        .calendar .weeks li {
            font-weight: 500;
        }


        .calendar ul {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
            text-align: center;
        }

        .calendar ul li {
            position: relative;
            width: calc(100% / 7);
        }

        .calendar .days li {
            z-index: 1;
            font-weight: 300;
            margin-top: 15px;
            cursor: pointer;
        }

        .days li.inactive {
            color: #aaa;
        }

        .days li.active {
            color: #fff;
            font-weight: 500;
        }

        .calendar .days li::before {
            position: absolute;
            content: "";
            height: 30px;
            width: 30px;
            top: 50%;
            left: 50%;
            z-index: -1;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .days li:hover::before {
            background: #878787;
        }

        .days li.active::before {
            background: #EC7E4A;
        }
    </style>
</head>

<body class="min-h-screen bg-[#343639] font-customFont ">
    <div id="content_container" class="">
        <div class="sidebar fixed top-0 left-0 h-full w-[85px] flex flex-col shadow-lg bg-50">
            <div class="flex items-center justify-center">
                <a href="#" class="list-none">
                    <img class="w-[80px] rounded-full" src="../../views/img/Flexperience logo.png" alt="Flexperience">
                </a>
            </div>

            <ul class="navbar list-none mt-14 h-[80px]" id="forActive">
                <!--Home-->
                <li>
                    <a href="adminDashboard.html" class="btn active flex items-center justify-center text-2xl">
                        <i class="bx bx-home-alt-2" aria-hidden="true" style="color:#ffffff"></i>
                    </a>
                    <span class="tooltip-home absolute text-lg">Home</span>
                </li>

                <!--Pending Gym Registration-->
                <li class="mt-6">
                    <a href="Pending.html" class="btn flex items-center justify-center text-2xl">
                        <i class='bx bx-time' style="color:white"></i> <!-- Changed to a clock icon -->
                    </a>
                    <span class="tooltip-maps absolute text-lg">Pending Gym Registration</span>
                </li>

                <!--Registered Gym-->
                <li class="mt-6">
                    <a href="Registered.html" class="btn flex items-center justify-center text-2xl">
                        <i class='bx bx-list-check' style="color:white"></i>
                    </a>
                    <span class="tooltip-workout absolute text-lg">Registered Gym</span>
                </li>

                <!-- Settings -->
                <li class="mt-6">
                    <a href="#" class="btn flex items-center justify-center text-2xl">
                        <i class='bx bx-cog' style="color: white;"></i>
                    </a>
                    <span class="tooltip-workout absolute text-lg">Settings</span>
                </li>
            </ul>
        </div>

        <div
            class="title_div flex flex-row justify-between text-white p-[20px] shadow-[2px_3px_rgb(39,39,39)] pt-[20px] mb-[20px] text-base font-light pl-[100px] bg-gradient-to-l from-[#1e1e1e] via-[#1e1e1e] to-[#343639]">
            <h1 class="">
                <span class="page_title font-normal text-xl">
                    Dashboard
                </span>
            </h1>
            <div class="topbar bg-transparent fixed top-0 w-full h-[55px] flex flex-row-reverse gap-2 p-5 items-center">
                <!--profile-->
                <div class="flex items-center justify-center mr-24 mt-0">
                    <button>
                        <img class="w-10 h-10 rounded-full object-cover border border-gray-400"
                            src="../../views/img/heinzprof.jpg" alt="ILISI LNG">
                    </button>
                </div>
                <!--notif-->
                <div class="mr-4">
                    <button>
                        <ion-icon name="notifications" class="notif text-white text-2xl mt-[1.2rem]"></ion-icon>
                    </button>
                </div>
                <!--darkmode/lightmode NOT FINISH HAHAHAHA TAYMPERS-->
                <div class="mr-4">
                    <label class="mode-label w-full h-[30px] flex items-center justify-center mt-[1rem]">
                        <input type="checkbox" class="mode">
                        <ion-icon name="moon" class="moon text-customGray1 text-base"></ion-icon>
                        <ion-icon name="sunny" class="sun text-customGray1 text-base"></ion-icon>
                        <span class="toggle w-[30px] h-[30px] bg-transparent"></span>
                        <span class="animateBG top-0 w-full h-[100vh]"></span>
                    </label>
                </div>
            </div>
        </div>

        <div class="flex justify-between">
            <div class="pl-[120px] pt-[40px] text-white font-sans">
                Good day, <br>
                <span class="text-4xl font-bold font-customFont">Admin!</span> <br>
                Pag trabaho na boss!

                <div class="mt-20 flex gap-5">
                    <a href="Registered.html"
                        class="text-white text-2xl w-auto py-10 px-10 border-2 border-border_color shadow-2xl bg-div_color hover:bg-50 hover:shadow-lg rounded-lg text-left duration-300 flex items-center gap-3">
                        <i class="fas fa-check-circle text-3xl"></i> <!-- Registered Icon -->
                        <div>
                            <span class="text-lg">Verified Gym(s)</span><br>
                            <span class="font-bold ml-3">1</span>
                        </div>
                    </a>
                    <a href="Pending.html"
                        class="text-white text-2xl w-auto py-10 px-10 border-2 border-border_color shadow-2xl bg-div_color hover:bg-50 hover:shadow-lg rounded-lg text-left duration-300 flex items-center gap-3">
                        <i class="fas fa-hourglass-half text-3xl"></i> <!-- Pending Icon -->
                        <div>
                            <span class="text-lg">Pending Gym Registration(s)</span><br>
                            <span class="font-bold ml-3">1</span>
                        </div>
                    </a>
                </div>
            </div>

            <div class="dashboard-Content text-sm text-white mr-10">
                <div class="wrapper w-[320px] bg-div_color shadow-lg  border-border_color border-2">
                    <header class="">
                        <p class="current-date"></p>
                        <div class="icons">
                            <span id="prev" class="materials-symbols-rounded text-black">
                                <i class='bx bx-chevron-left text-xl'></i>
                            </span>
                            <span id="next" class="materials-symbols-rounded text-black">
                                <i class='bx bx-chevron-right text-xl'></i>
                            </span>
                        </div>
                    </header>
                    <div class="calendar">
                        <ul class="weeks">
                            <li>Sun</li>
                            <li>Mon</li>
                            <li>Tue</li>
                            <li>Wed</li>
                            <li>Thu</li>
                            <li>Fri</li>
                            <li>Sat</li>
                        </ul>
                        <ul class="days"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container w-full p-4 pl-[120px] shadow-lg">
        <h2 class="text-white text-2xl font-bold mb-4 mt-10">Gym Registrations Overview</h2>
        <div class="bg-div_color p-6 shadow-xl w-full border-border_color border-2 rounded-lg">
            <table class="w-full text-white table-auto border-collapse rounded-sm">
                <thead>
                    <tr class="bg-50">
                        <th class="p-3 border-b-2 border-border_color text-center">Gym Admin</th>
                        <th class="p-3 border-b-2 border-border_color text-center">Gym Name</th>
                        <th class="p-3 border-b-2 border-border_color text-center">Street Address</th>
                        <th class="p-3 border-b-2 border-border_color text-center">Subscription</th>
                        <th class="p-3 border-b-2 border-border_color text-center">Subscription Status</th>
                    </tr>
                </thead>
                <tbody id="gym-data">
                    <!-- Dynamic data will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>



</body>

</html>
<script src="../../scripts/admin.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"></script>
<script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script>
    //calendar

    const currentDate = document.querySelector(".current-date"),
        daysTag = document.querySelector(".days"),
        prevNextIcon = document.querySelectorAll(".icons span");

    //getting new date, current year and month
    let date = new Date(),
        currYear = date.getFullYear(),
        currMonth = date.getMonth();

    const months = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"];

    const renderCalendar = () => {
        let firstDayofMonth = new Date(currYear, currMonth, 1).getDay(), //first day
            lastDateofMonth = new Date(currYear, currMonth + 1, 0).getDate(), //last date sa month
            lastDayofMonth = new Date(currYear, currMonth, lastDateofMonth).getDay(), //last day sa month
            lastDateofLastMonth = new Date(currYear, currMonth, 0).getDate(); //last date previous month
        let liTag = "";

        for (let i = firstDayofMonth; i > 0; i--) { //previous month last days
            liTag += `<li class="inactive">${lastDateofLastMonth - i + 1}</li>`;
        }

        for (let i = 1; i <= lastDateofMonth; i++) { // all days of current month

            //current day,month, year active
            let isToday = i === date.getDate() && currMonth === new Date().getMonth()
                && currYear === new Date().getFullYear() ? "active" : "";
            liTag += `<li class="${isToday}">${i}</li>`;
        }

        for (let i = lastDayofMonth; i < 6; i++) { //next month first days
            liTag += `<li class="inactive">${i - lastDayofMonth + 1}</li>`;
        }

        currentDate.innerText = `${months[currMonth]} ${currYear}`;
        daysTag.innerHTML = liTag;
    }
    renderCalendar();

    //click event sa icons
    prevNextIcon.forEach(icon => {
        icon.addEventListener("click", () => {
            currMonth = icon.id === "prev" ? currMonth - 1 : currMonth + 1;

            if (currMonth < 0 || currMonth > 11) {
                date = new Date(currYear, currMonth);
                currYear = date.getFullYear(); //updates current year with new date year
                currMonth = date.getMonth(); //updates current month with new date month
            } else { //pass new date as date value
                date = new Date();
            }
            renderCalendar();
        });
    });

    // Function to dynamically populate the table
    function populateTable(data) {
        const tbody = document.getElementById('gym-data');
        tbody.innerHTML = ''; // Clear the table before appending new data

        data.forEach(item => {
            // Create a table row
            const tr = document.createElement('tr');
            tr.classList.add('bg-gray-800', 'hover:bg-gray-600');

            // Insert table data cells with the response data
            tr.innerHTML = `
                <td class="p-3 border-b border-border_color text-center align-middle">${item.gym_admin}</td>
                <td class="p-3 border-b border-border_color text-center align-middle">${item.gym_name}</td>
                <td class="p-3 border-b border-border_color text-center align-middle">${item.street_address}</td>
                <td class="p-3 border-b border-border_color text-center align-middle">${item.Subscription}</td>
                <td class="p-3 border-b border-border_color text-center align-middle">
                    <span class="bg-50 text-white px-2 py-1 rounded-full ${item.membership_status === 'Active' ? 'bg-green-600' : 'bg-gray-500'}">
                        ${item.membership_status}
                    </span>
                </td>
            `;
            // Append the row to the table body
            tbody.appendChild(tr);
        });
    }

    // Function to fetch data using Axios
    function fetchGymData() {
        axios.get('http://localhost:3000/getVerifiedAdmins')
            .then(response => {
                // Populate the table with data from the response
                populateTable(response.data);
            })
            .catch(error => {
                console.error('There was an error fetching the gym data!', error);
            });
    }

    // Fetch the data when the page loads
    window.onload = fetchGymData;
</script>